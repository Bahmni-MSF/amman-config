<?xml version="1.0" encoding="UTF-8"?>

<databaseChangeLog
        xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xmlns:ext="http://www.liquibase.org/xml/ns/dbchangelog-ext"
        xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-2.0.xsd
        http://www.liquibase.org/xml/ns/dbchangelog-ext http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-ext.xsd">

    <!---Change Set For addition of concepts to openmrs -->
    <changeSet id="AMMAN_CONFIG_202102010001" author="Tarun">
        <comment>Adding Concepts for Psycho Social assessment form</comment>
        <sqlFile path="concepts/addPsychoSocialConcept.sql"/>
    </changeSet>

    <changeSet id="AMMAN_CONFIG_202102010002" author="Tarun">
        <preConditions onFail="MARK_RAN">
            <sqlCheck expectedResult="0">
                select count(*) from concept_answer ca
                join
                concept_name cn
                on ca.concept_id = cn.concept_id
                where ca.answer_concept IN (select concept_id from concept_name where name IN
                ("Initial","Follow-up","Discharge")
                and concept_name_type = "FULLY_SPECIFIED")
                AND
                cn.concept_id IN (select concept_id from concept_name where name = "PSA, Type of assessment");
            </sqlCheck>
        </preConditions>
        <comment>Adding Answers to Type of assessment</comment>
        <sql>
            select concept_id into @concept_id from concept_name where name = "PSA, Type of assessment" and
            concept_name_type = 'FULLY_SPECIFIED' and locale = "en" and voided = 0;
            set @child1_concept_id = 0;
            set @child2_concept_id = 0;
            set @child3_concept_id = 0;
            select concept_id into @child1_concept_id from concept_name where name ="Initial" and concept_name_type = 'FULLY_SPECIFIED' and locale = 'en' and voided = 0;
            select concept_id into @child2_concept_id from concept_name where name ="Follow-up" and concept_name_type = 'FULLY_SPECIFIED' and locale = 'en' and voided = 0;
            select concept_id into @child3_concept_id from concept_name where name ="Discharge" and concept_name_type = 'FULLY_SPECIFIED' and locale = 'en' and voided = 0;
            call add_concept_answer(@concept_id, @child1_concept_id, 1);
            call add_concept_answer(@concept_id, @child2_concept_id, 2);
            call add_concept_answer(@concept_id, @child3_concept_id, 3);
        </sql>
    </changeSet>

    <changeSet id="AMMAN_CONFIG_202102010003" author="Tarun">
        <preConditions onFail="MARK_RAN">
            <sqlCheck expectedResult="0">
                select count(*) from concept_answer ca
                join
                concept_name cn
                on ca.concept_id = cn.concept_id
                where ca.answer_concept IN (select concept_id from concept_name where name IN
                ("Individual session", "Family support session", "Joint session with med/physio")
                and concept_name_type = "FULLY_SPECIFIED")
                AND
                cn.concept_id IN (select concept_id from concept_name where name = "PSA, Type of activity");
            </sqlCheck>
        </preConditions>
        <comment>Adding Answers to Type of activity</comment>
        <sql>
            select concept_id into @concept_id from concept_name where name = "PSA, Type of activity" and
            concept_name_type = 'FULLY_SPECIFIED' and locale = "en" and voided = 0;
            set @child1_concept_id = 0;
            set @child2_concept_id = 0;
            set @child3_concept_id = 0;
            select concept_id into @child1_concept_id from concept_name where name ="Individual session" and concept_name_type = 'FULLY_SPECIFIED' and locale = 'en' and voided = 0;
            select concept_id into @child2_concept_id from concept_name where name ="Family support session" and concept_name_type = 'FULLY_SPECIFIED' and locale = 'en' and voided = 0;
            select concept_id into @child3_concept_id from concept_name where name ="Joint session with med/physio" and concept_name_type = 'FULLY_SPECIFIED' and locale = 'en' and voided = 0;
            call add_concept_answer(@concept_id, @child1_concept_id, 1);
            call add_concept_answer(@concept_id, @child2_concept_id, 2);
            call add_concept_answer(@concept_id, @child3_concept_id, 3);
        </sql>
    </changeSet>

    <changeSet id="AMMAN_CONFIG_202102010004" author="Tarun">
        <preConditions onFail="MARK_RAN">
            <sqlCheck expectedResult="0">
                select count(*) from concept_answer ca
                join
                concept_name cn
                on ca.concept_id = cn.concept_id
                where ca.answer_concept IN (select concept_id from concept_name where name IN
                ("First assessment by MH team", "Medical round", "Doctor/ nurses/physio", "Request from family", "Peer counselor", "Other")
                and concept_name_type = "FULLY_SPECIFIED")
                AND
                cn.concept_id IN (select concept_id from concept_name where name = "PSA, Referral source");
            </sqlCheck>
        </preConditions>
        <comment>Adding Answers to Referral source</comment>
        <sql>
            select concept_id into @concept_id from concept_name where name = "PSA, Referral source" and
            concept_name_type = 'FULLY_SPECIFIED' and locale = "en" and voided = 0;
            set @child1_concept_id = 0;
            set @child2_concept_id = 0;
            set @child3_concept_id = 0;
            set @child4_concept_id = 0;
            set @child5_concept_id = 0;
            set @child6_concept_id = 0;
            select concept_id into @child1_concept_id from concept_name where name ="First assessment by MH team" and concept_name_type = 'FULLY_SPECIFIED' and locale = 'en' and voided = 0;
            select concept_id into @child2_concept_id from concept_name where name ="Medical round" and concept_name_type = 'FULLY_SPECIFIED' and locale = 'en' and voided = 0;
            select concept_id into @child3_concept_id from concept_name where name ="Doctor/ nurses/physio" and concept_name_type = 'FULLY_SPECIFIED' and locale = 'en' and voided = 0;
            select concept_id into @child4_concept_id from concept_name where name ="Request from family" and concept_name_type = 'FULLY_SPECIFIED' and locale = 'en' and voided = 0;
            select concept_id into @child5_concept_id from concept_name where name ="Peer counselor" and concept_name_type = 'FULLY_SPECIFIED' and locale = 'en' and voided = 0;
            select concept_id into @child6_concept_id from concept_name where name ="Other" and concept_name_type = 'FULLY_SPECIFIED' and locale = 'en' and voided = 0;
            call add_concept_answer(@concept_id, @child1_concept_id, 1);
            call add_concept_answer(@concept_id, @child2_concept_id, 2);
            call add_concept_answer(@concept_id, @child3_concept_id, 3);
            call add_concept_answer(@concept_id, @child4_concept_id, 4);
            call add_concept_answer(@concept_id, @child5_concept_id, 5);
            call add_concept_answer(@concept_id, @child6_concept_id, 6);
        </sql>
    </changeSet>

    <changeSet id="AMMAN_CONFIG_202102010005" author="Tarun">
        <preConditions onFail="MARK_RAN">
            <sqlCheck expectedResult="0">
                select count(*) from concept_answer ca
                join
                concept_name cn
                on ca.concept_id = cn.concept_id
                where ca.answer_concept IN (select concept_id from concept_name where name IN
                ("Adult living alone", "Adult living with family", "Adult single parent family", "Minor isolated", "Minor living with family")
                and concept_name_type = "FULLY_SPECIFIED")
                AND
                cn.concept_id IN (select concept_id from concept_name where name = "PSA, Personal situation at home");
            </sqlCheck>
        </preConditions>
        <comment>Adding Answers to Personal situation at home</comment>
        <sql>
            select concept_id into @concept_id from concept_name where name = "PSA, Personal situation at home" and
            concept_name_type = 'FULLY_SPECIFIED' and locale = "en" and voided = 0;
            set @child1_concept_id = 0;
            set @child2_concept_id = 0;
            set @child3_concept_id = 0;
            set @child4_concept_id = 0;
            set @child5_concept_id = 0;
            select concept_id into @child1_concept_id from concept_name where name ="Adult living alone" and concept_name_type = 'FULLY_SPECIFIED' and locale = 'en' and voided = 0;
            select concept_id into @child2_concept_id from concept_name where name ="Adult living with family" and concept_name_type = 'FULLY_SPECIFIED' and locale = 'en' and voided = 0;
            select concept_id into @child3_concept_id from concept_name where name ="Adult single parent family" and concept_name_type = 'FULLY_SPECIFIED' and locale = 'en' and voided = 0;
            select concept_id into @child4_concept_id from concept_name where name ="Minor isolated" and concept_name_type = 'FULLY_SPECIFIED' and locale = 'en' and voided = 0;
            select concept_id into @child5_concept_id from concept_name where name ="Minor living with family" and concept_name_type = 'FULLY_SPECIFIED' and locale = 'en' and voided = 0;
            call add_concept_answer(@concept_id, @child1_concept_id, 1);
            call add_concept_answer(@concept_id, @child2_concept_id, 2);
            call add_concept_answer(@concept_id, @child3_concept_id, 3);
            call add_concept_answer(@concept_id, @child4_concept_id, 4);
            call add_concept_answer(@concept_id, @child5_concept_id, 4);
        </sql>
    </changeSet>

    <changeSet id="AMMAN_CONFIG_202102010006" author="Tarun">
        <preConditions onFail="MARK_RAN">
            <sqlCheck expectedResult="0">
                select count(*) from concept_answer ca
                join
                concept_name cn
                on ca.concept_id = cn.concept_id
                where ca.answer_concept IN (select concept_id from concept_name where name IN
                ("Family member staying with patient", "Regular contact with family", "Isolated patient", "Patient poorly supported")
                and concept_name_type = "FULLY_SPECIFIED")
                AND
                cn.concept_id IN (select concept_id from concept_name where name = "PSA, Personal situation in hospital");
            </sqlCheck>
        </preConditions>
        <comment>Adding Answers to Personal situation in hospital</comment>
        <sql>
            select concept_id into @concept_id from concept_name where name = "PSA, Personal situation in hospital" and
            concept_name_type = 'FULLY_SPECIFIED' and locale = "en" and voided = 0;
            set @child1_concept_id = 0;
            set @child2_concept_id = 0;
            set @child3_concept_id = 0;
            set @child4_concept_id = 0;
            select concept_id into @child1_concept_id from concept_name where name ="Family member staying with patient" and concept_name_type = 'FULLY_SPECIFIED' and locale = 'en' and voided = 0;
            select concept_id into @child2_concept_id from concept_name where name ="Regular contact with family" and concept_name_type = 'FULLY_SPECIFIED' and locale = 'en' and voided = 0;
            select concept_id into @child3_concept_id from concept_name where name ="Isolated patient" and concept_name_type = 'FULLY_SPECIFIED' and locale = 'en' and voided = 0;
            select concept_id into @child4_concept_id from concept_name where name ="Patient poorly supported" and concept_name_type = 'FULLY_SPECIFIED' and locale = 'en' and voided = 0;
            call add_concept_answer(@concept_id, @child1_concept_id, 1);
            call add_concept_answer(@concept_id, @child2_concept_id, 2);
            call add_concept_answer(@concept_id, @child3_concept_id, 3);
            call add_concept_answer(@concept_id, @child4_concept_id, 4);
        </sql>
    </changeSet>

    <changeSet id="AMMAN_CONFIG_202102010007" author="Tarun">
        <preConditions onFail="MARK_RAN">
            <sqlCheck expectedResult="0">
                select count(*) from concept_answer ca
                join
                concept_name cn
                on ca.concept_id = cn.concept_id
                where ca.answer_concept IN (select concept_id from concept_name where name IN
                ("No", "Yes: Traditional / religious healer", "Yes: Clinical professional without psychotropic prescription", "Yes: Clinical professional with prescription")
                and concept_name_type = "FULLY_SPECIFIED")
                AND
                cn.concept_id IN (select concept_id from concept_name where name = "PSA, Previous MH treatment");
            </sqlCheck>
        </preConditions>
        <comment>Adding Answers to Previous MH treatment</comment>
        <sql>
            select concept_id into @concept_id from concept_name where name = "PSA, Previous MH treatment" and
            concept_name_type = 'FULLY_SPECIFIED' and locale = "en" and voided = 0;
            set @child1_concept_id = 0;
            set @child2_concept_id = 0;
            set @child3_concept_id = 0;
            set @child4_concept_id = 0;
            select concept_id into @child1_concept_id from concept_name where name ="No" and concept_name_type = 'FULLY_SPECIFIED' and locale = 'en' and voided = 0;
            select concept_id into @child2_concept_id from concept_name where name ="Yes: Traditional / religious healer" and concept_name_type = 'FULLY_SPECIFIED' and locale = 'en' and voided = 0;
            select concept_id into @child3_concept_id from concept_name where name ="Yes: Clinical professional without psychotropic prescription" and concept_name_type = 'FULLY_SPECIFIED' and locale = 'en' and voided = 0;
            select concept_id into @child4_concept_id from concept_name where name ="Yes: Clinical professional with prescription" and concept_name_type = 'FULLY_SPECIFIED' and locale = 'en' and voided = 0;
            call add_concept_answer(@concept_id, @child1_concept_id, 1);
            call add_concept_answer(@concept_id, @child2_concept_id, 2);
            call add_concept_answer(@concept_id, @child3_concept_id, 3);
            call add_concept_answer(@concept_id, @child4_concept_id, 4);
        </sql>
    </changeSet>

    <changeSet id="AMMAN_CONFIG_202102010008" author="Tarun">
        <preConditions onFail="MARK_RAN">
            <sqlCheck expectedResult="0">
                select count(*) from concept_answer ca
                join
                concept_name cn
                on ca.concept_id = cn.concept_id
                where ca.answer_concept IN (select concept_id from concept_name where name IN
                ("Normal", "Borderline mentally ill", "Midly ill", "Moderately ill", "Markedly ill", "Severely ill", "Among the most extremely ill")
                and concept_name_type = "FULLY_SPECIFIED")
                AND
                cn.concept_id IN (select concept_id from concept_name where name = "PSA, Severity of symptoms (CGI-S scale)");
            </sqlCheck>
        </preConditions>
        <comment>Adding Answers to Severity of symptoms (CGI-S scale)</comment>
        <sql>
            select concept_id into @concept_id from concept_name where name = "PSA, Severity of symptoms (CGI-S scale)" and
            concept_name_type = 'FULLY_SPECIFIED' and locale = "en" and voided = 0;
            set @child1_concept_id = 0;
            set @child2_concept_id = 0;
            set @child3_concept_id = 0;
            set @child4_concept_id = 0;
            set @child5_concept_id = 0;
            set @child6_concept_id = 0;
            set @child7_concept_id = 0;
            select concept_id into @child1_concept_id from concept_name where name ="Normal" and concept_name_type = 'FULLY_SPECIFIED' and locale = 'en' and voided = 0;
            select concept_id into @child2_concept_id from concept_name where name ="Borderline mentally ill" and concept_name_type = 'FULLY_SPECIFIED' and locale = 'en' and voided = 0;
            select concept_id into @child3_concept_id from concept_name where name ="Midly ill" and concept_name_type = 'FULLY_SPECIFIED' and locale = 'en' and voided = 0;
            select concept_id into @child4_concept_id from concept_name where name ="Moderately ill" and concept_name_type = 'FULLY_SPECIFIED' and locale = 'en' and voided = 0;
            select concept_id into @child5_concept_id from concept_name where name ="Markedly ill" and concept_name_type = 'FULLY_SPECIFIED' and locale = 'en' and voided = 0;
            select concept_id into @child6_concept_id from concept_name where name ="Severely ill" and concept_name_type = 'FULLY_SPECIFIED' and locale = 'en' and voided = 0;
            select concept_id into @child7_concept_id from concept_name where name ="Among the most extremely ill" and concept_name_type = 'FULLY_SPECIFIED' and locale = 'en' and voided = 0;
            call add_concept_answer(@concept_id, @child1_concept_id, 1);
            call add_concept_answer(@concept_id, @child2_concept_id, 2);
            call add_concept_answer(@concept_id, @child3_concept_id, 3);
            call add_concept_answer(@concept_id, @child4_concept_id, 4);
            call add_concept_answer(@concept_id, @child5_concept_id, 5);
            call add_concept_answer(@concept_id, @child6_concept_id, 6);
            call add_concept_answer(@concept_id, @child7_concept_id, 7);
        </sql>
    </changeSet>

    <changeSet id="AMMAN_CONFIG_202102010009" author="Tarun">
        <preConditions onFail="MARK_RAN">
            <sqlCheck expectedResult="0">
                select count(*) from concept_answer ca
                join
                concept_name cn
                on ca.concept_id = cn.concept_id
                where ca.answer_concept IN (select concept_id from concept_name where name IN
                ("Very much improved", "Much improved", "Minimally improved", "No change", "Minimally worse", "Much worse", "Very much worse")
                and concept_name_type = "FULLY_SPECIFIED")
                AND
                cn.concept_id IN (select concept_id from concept_name where name = "PSA, Improvement / outcomes (CGI-I scale)");
            </sqlCheck>
        </preConditions>
        <comment>Adding Answers to Improvement / outcomes (CGI-I scale)</comment>
        <sql>
            select concept_id into @concept_id from concept_name where name = "PSA, Improvement / outcomes (CGI-I scale)" and
            concept_name_type = 'FULLY_SPECIFIED' and locale = "en" and voided = 0;
            set @child1_concept_id = 0;
            set @child2_concept_id = 0;
            set @child3_concept_id = 0;
            set @child4_concept_id = 0;
            set @child5_concept_id = 0;
            set @child6_concept_id = 0;
            set @child7_concept_id = 0;
            select concept_id into @child1_concept_id from concept_name where name ="Very much improved" and concept_name_type = 'FULLY_SPECIFIED' and locale = 'en' and voided = 0;
            select concept_id into @child2_concept_id from concept_name where name ="Much improved" and concept_name_type = 'FULLY_SPECIFIED' and locale = 'en' and voided = 0;
            select concept_id into @child3_concept_id from concept_name where name ="Minimally improved" and concept_name_type = 'FULLY_SPECIFIED' and locale = 'en' and voided = 0;
            select concept_id into @child4_concept_id from concept_name where name ="No change" and concept_name_type = 'FULLY_SPECIFIED' and locale = 'en' and voided = 0;
            select concept_id into @child5_concept_id from concept_name where name ="Minimally worse" and concept_name_type = 'FULLY_SPECIFIED' and locale = 'en' and voided = 0;
            select concept_id into @child6_concept_id from concept_name where name ="Much worse" and concept_name_type = 'FULLY_SPECIFIED' and locale = 'en' and voided = 0;
            select concept_id into @child7_concept_id from concept_name where name ="Very much worse" and concept_name_type = 'FULLY_SPECIFIED' and locale = 'en' and voided = 0;
            call add_concept_answer(@concept_id, @child1_concept_id, 1);
            call add_concept_answer(@concept_id, @child2_concept_id, 2);
            call add_concept_answer(@concept_id, @child3_concept_id, 3);
            call add_concept_answer(@concept_id, @child4_concept_id, 4);
            call add_concept_answer(@concept_id, @child5_concept_id, 5);
            call add_concept_answer(@concept_id, @child6_concept_id, 6);
            call add_concept_answer(@concept_id, @child7_concept_id, 6);
        </sql>
    </changeSet>

    <changeSet id="AMMAN_CONFIG_202102010010" author="Tarun">
        <preConditions onFail="MARK_RAN">
            <sqlCheck expectedResult="0">
                select count(*) from concept_answer ca
                join
                concept_name cn
                on ca.concept_id = cn.concept_id
                where ca.answer_concept IN (select concept_id from concept_name where name IN
                ("Depression", "Anxiety", "Trauma related", "Psychosis (≥15 years)", "Behavioral/substance (≥ 15yrs)", "Behavioral (&lt;15yrs)", "Neurocognitive", "Psychosomatic / MUPS", "Epilepsy / seizure")
                and concept_name_type = "FULLY_SPECIFIED")
                AND
                cn.concept_id IN (select concept_id from concept_name where name = "PSA, Syndrome");
            </sqlCheck>
        </preConditions>
        <comment>Adding Answers to Syndrome</comment>
        <sql>
            select concept_id into @concept_id from concept_name where name = "PSA, Syndrome" and
            concept_name_type = 'FULLY_SPECIFIED' and locale = "en" and voided = 0;
            set @child1_concept_id = 0;
            set @child2_concept_id = 0;
            set @child3_concept_id = 0;
            set @child4_concept_id = 0;
            set @child5_concept_id = 0;
            set @child6_concept_id = 0;
            set @child7_concept_id = 0;
            set @child8_concept_id = 0;
            set @child9_concept_id = 0;
            select concept_id into @child1_concept_id from concept_name where name ="Depression" and concept_name_type = 'FULLY_SPECIFIED' and locale = 'en' and voided = 0;
            select concept_id into @child2_concept_id from concept_name where name ="Anxiety" and concept_name_type = 'FULLY_SPECIFIED' and locale = 'en' and voided = 0;
            select concept_id into @child3_concept_id from concept_name where name ="Trauma related" and concept_name_type = 'FULLY_SPECIFIED' and locale = 'en' and voided = 0;
            select concept_id into @child4_concept_id from concept_name where name ="Psychosis (≥15 years)" and concept_name_type = 'FULLY_SPECIFIED' and locale = 'en' and voided = 0;
            select concept_id into @child5_concept_id from concept_name where name ="Behavioral/substance (≥ 15yrs)" and concept_name_type = 'FULLY_SPECIFIED' and locale = 'en' and voided = 0;
            select concept_id into @child6_concept_id from concept_name where name ="Behavioral (&lt;15yrs)" and concept_name_type = 'FULLY_SPECIFIED' and locale = 'en' and voided = 0;
            select concept_id into @child7_concept_id from concept_name where name ="Neurocognitive" and concept_name_type = 'FULLY_SPECIFIED' and locale = 'en' and voided = 0;
            select concept_id into @child8_concept_id from concept_name where name ="Psychosomatic / MUPS" and concept_name_type = 'FULLY_SPECIFIED' and locale = 'en' and voided = 0;
            select concept_id into @child9_concept_id from concept_name where name ="Epilepsy / seizure" and concept_name_type = 'FULLY_SPECIFIED' and locale = 'en' and voided = 0;
            call add_concept_answer(@concept_id, @child1_concept_id, 1);
            call add_concept_answer(@concept_id, @child2_concept_id, 2);
            call add_concept_answer(@concept_id, @child3_concept_id, 3);
            call add_concept_answer(@concept_id, @child4_concept_id, 4);
            call add_concept_answer(@concept_id, @child5_concept_id, 5);
            call add_concept_answer(@concept_id, @child6_concept_id, 6);
            call add_concept_answer(@concept_id, @child7_concept_id, 7);
            call add_concept_answer(@concept_id, @child8_concept_id, 8);
            call add_concept_answer(@concept_id, @child9_concept_id, 9);
        </sql>
    </changeSet>

    <changeSet id="AMMAN_CONFIG_202102010011" author="Tarun">
        <preConditions onFail="MARK_RAN">
            <sqlCheck expectedResult="0">
                select count(*) from concept_answer ca
                join
                concept_name cn
                on ca.concept_id = cn.concept_id
                where ca.answer_concept IN (select concept_id from concept_name where name IN
                ("Depression", "Anxiety", "Trauma related", "Psychosis (≥15 years)", "Behavioral/substance (≥ 15yrs)", "Behavioral (&lt;15yrs)", "Neurocognitive", "Psychosomatic / MUPS", "Epilepsy / seizure")
                and concept_name_type = "FULLY_SPECIFIED")
                AND
                cn.concept_id IN (select concept_id from concept_name where name = "PSA, Secondary Syndrome");
            </sqlCheck>
        </preConditions>
        <comment>Adding Answers to Secondary Syndrome</comment>
        <sql>
            select concept_id into @concept_id from concept_name where name = "PSA, Secondary Syndrome" and
            concept_name_type = 'FULLY_SPECIFIED' and locale = "en" and voided = 0;
            set @child1_concept_id = 0;
            set @child2_concept_id = 0;
            set @child3_concept_id = 0;
            set @child4_concept_id = 0;
            set @child5_concept_id = 0;
            set @child6_concept_id = 0;
            set @child7_concept_id = 0;
            set @child8_concept_id = 0;
            set @child9_concept_id = 0;
            select concept_id into @child1_concept_id from concept_name where name ="Depression" and concept_name_type = 'FULLY_SPECIFIED' and locale = 'en' and voided = 0;
            select concept_id into @child2_concept_id from concept_name where name ="Anxiety" and concept_name_type = 'FULLY_SPECIFIED' and locale = 'en' and voided = 0;
            select concept_id into @child3_concept_id from concept_name where name ="Trauma related" and concept_name_type = 'FULLY_SPECIFIED' and locale = 'en' and voided = 0;
            select concept_id into @child4_concept_id from concept_name where name ="Psychosis (≥15 years)" and concept_name_type = 'FULLY_SPECIFIED' and locale = 'en' and voided = 0;
            select concept_id into @child5_concept_id from concept_name where name ="Behavioral/substance (≥ 15yrs)" and concept_name_type = 'FULLY_SPECIFIED' and locale = 'en' and voided = 0;
            select concept_id into @child6_concept_id from concept_name where name ="Behavioral (&lt;15yrs)" and concept_name_type = 'FULLY_SPECIFIED' and locale = 'en' and voided = 0;
            select concept_id into @child7_concept_id from concept_name where name ="Neurocognitive" and concept_name_type = 'FULLY_SPECIFIED' and locale = 'en' and voided = 0;
            select concept_id into @child8_concept_id from concept_name where name ="Psychosomatic / MUPS" and concept_name_type = 'FULLY_SPECIFIED' and locale = 'en' and voided = 0;
            select concept_id into @child9_concept_id from concept_name where name ="Epilepsy / seizure" and concept_name_type = 'FULLY_SPECIFIED' and locale = 'en' and voided = 0;
            call add_concept_answer(@concept_id, @child1_concept_id, 1);
            call add_concept_answer(@concept_id, @child2_concept_id, 2);
            call add_concept_answer(@concept_id, @child3_concept_id, 3);
            call add_concept_answer(@concept_id, @child4_concept_id, 4);
            call add_concept_answer(@concept_id, @child5_concept_id, 5);
            call add_concept_answer(@concept_id, @child6_concept_id, 6);
            call add_concept_answer(@concept_id, @child7_concept_id, 7);
            call add_concept_answer(@concept_id, @child8_concept_id, 8);
            call add_concept_answer(@concept_id, @child9_concept_id, 9);
        </sql>
    </changeSet>

    <changeSet id="AMMAN_CONFIG_202102010012" author="Tarun">
        <preConditions onFail="MARK_RAN">
            <sqlCheck expectedResult="0">
                select count(*) from concept_answer ca
                join
                concept_name cn
                on ca.concept_id = cn.concept_id
                where ca.answer_concept IN (select concept_id from concept_name where name IN
                ("Yes", "No: Assessment without follow-up")
                and concept_name_type = "FULLY_SPECIFIED")
                AND
                cn.concept_id IN (select concept_id from concept_name where name = "PSA, Does the patient need a follow-up?");
            </sqlCheck>
        </preConditions>
        <comment>Adding Answers to Does the patient need a follow-up?</comment>
        <sql>
            select concept_id into @concept_id from concept_name where name = "PSA, Does the patient need a follow-up?" and
            concept_name_type = 'FULLY_SPECIFIED' and locale = "en" and voided = 0;
            set @child1_concept_id = 0;
            set @child2_concept_id = 0;
            select concept_id into @child1_concept_id from concept_name where name ="Yes" and concept_name_type = 'FULLY_SPECIFIED' and locale = 'en' and voided = 0;
            select concept_id into @child2_concept_id from concept_name where name ="No: Assessment without follow-up" and concept_name_type = 'FULLY_SPECIFIED' and locale = 'en' and voided = 0;
            call add_concept_answer(@concept_id, @child1_concept_id, 1);
            call add_concept_answer(@concept_id, @child2_concept_id, 2);
        </sql>
    </changeSet>

    <changeSet id="AMMAN_CONFIG_202102010013" author="Tarun">
        <preConditions onFail="MARK_RAN">
            <sqlCheck expectedResult="0">
                select count(*) from concept_answer ca
                join
                concept_name cn
                on ca.concept_id = cn.concept_id
                where ca.answer_concept IN (select concept_id from concept_name where name IN
                ("Yes", "No")
                and concept_name_type = "FULLY_SPECIFIED")
                AND
                cn.concept_id IN (select concept_id from concept_name where name = "PSA, Presence of patient");
            </sqlCheck>
        </preConditions>
        <comment>Adding Answers to Presence of patient</comment>
        <sql>
            select concept_id into @concept_id from concept_name where name = "PSA, Presence of patient" and
            concept_name_type = 'FULLY_SPECIFIED' and locale = "en" and voided = 0;
            set @child1_concept_id = 0;
            set @child2_concept_id = 0;
            select concept_id into @child1_concept_id from concept_name where name ="Yes" and concept_name_type = 'FULLY_SPECIFIED' and locale = 'en' and voided = 0;
            select concept_id into @child2_concept_id from concept_name where name ="No" and concept_name_type = 'FULLY_SPECIFIED' and locale = 'en' and voided = 0;
            call add_concept_answer(@concept_id, @child1_concept_id, 1);
            call add_concept_answer(@concept_id, @child2_concept_id, 2);
        </sql>
    </changeSet>

    <changeSet id="AMMAN_CONFIG_202102010014" author="Tarun">
        <preConditions onFail="MARK_RAN">
            <sqlCheck expectedResult="0">
                select count(*) from concept_answer ca
                join
                concept_name cn
                on ca.concept_id = cn.concept_id
                where ca.answer_concept IN (select concept_id from concept_name where name IN
                ("Discharge: End of MH follow-up (programs continues)", "Discharge: End of program / End of MH follow-up", "Discharge: End of program / Patient referred to other MH services", "Discharge: End of program / MH needs but no referral possible")
                and concept_name_type = "FULLY_SPECIFIED")
                AND
                cn.concept_id IN (select concept_id from concept_name where name = "PSA, Reason of discharge");
            </sqlCheck>
        </preConditions>
        <comment>Adding Answers to Reason of discharge</comment>
        <sql>
            select concept_id into @concept_id from concept_name where name = "PSA, Reason of discharge" and
            concept_name_type = 'FULLY_SPECIFIED' and locale = "en" and voided = 0;
            set @child1_concept_id = 0;
            set @child2_concept_id = 0;
            set @child3_concept_id = 0;
            set @child4_concept_id = 0;
            select concept_id into @child1_concept_id from concept_name where name ="Discharge: End of MH follow-up (programs continues)" and concept_name_type = 'FULLY_SPECIFIED' and locale = 'en' and voided = 0;
            select concept_id into @child2_concept_id from concept_name where name ="Discharge: End of program / End of MH follow-up" and concept_name_type = 'FULLY_SPECIFIED' and locale = 'en' and voided = 0;
            select concept_id into @child3_concept_id from concept_name where name ="Discharge: End of program / Patient referred to other MH services" and concept_name_type = 'FULLY_SPECIFIED' and locale = 'en' and voided = 0;
            select concept_id into @child4_concept_id from concept_name where name ="Discharge: End of program / MH needs but no referral possible" and concept_name_type = 'FULLY_SPECIFIED' and locale = 'en' and voided = 0;
            call add_concept_answer(@concept_id, @child1_concept_id, 1);
            call add_concept_answer(@concept_id, @child2_concept_id, 2);
            call add_concept_answer(@concept_id, @child3_concept_id, 3);
            call add_concept_answer(@concept_id, @child4_concept_id, 4);
        </sql>
    </changeSet>

    <changeSet id="AMMAN_CONFIG_202102010015" author="Tarun">
        <comment>Adding codes to specific concepts</comment>
        <sql>
            SELECT concept_source_id INTO @source_id FROM concept_reference_source where name = 'CEIL';

            call CREATE_REFERENCE_MAPPING_CEIL("PSA, Date of consultation","162869");
        </sql>
    </changeSet>

    <changeSet id="AMMAN_CONFIG_202102010016" author="Tarun">
        <preConditions onFail="MARK_RAN">
            <sqlCheck expectedResult="0">
                select count(*) from concept_answer ca
                join
                concept_name cn
                on ca.concept_id = cn.concept_id
                where ca.answer_concept IN (select concept_id from concept_name where name IN
                ("PSA, Date of consultation","PSA, Type of assessment","PSA, Type of activity","PSA, General information","PSA, Clinical assessment","PSA, Screening tool","PSA, Findings","PSA, Discharge Assessment")
                and concept_name_type = "FULLY_SPECIFIED")
                AND
                cn.concept_id IN (select concept_id from concept_name where name = "PSA, Psycho-Social Assessment");
            </sqlCheck>
        </preConditions>
        <comment>Adding Set Members to Psycho-Social Assessment</comment>
        <sql>
            select concept_id into @concept_id from concept_name where name = "PSA, Psycho-Social Assessment" and
            concept_name_type = 'FULLY_SPECIFIED' and locale = "en" and voided = 0;
            set @member1_concept_id = 0;
            set @member2_concept_id = 0;
            set @member3_concept_id = 0;
            set @member4_concept_id = 0;
            set @member5_concept_id = 0;
            set @member6_concept_id = 0;
            set @member7_concept_id = 0;
            set @member8_concept_id = 0;
            select concept_id into @member1_concept_id from concept_name where name ="PSA, Date of consultation" and concept_name_type = 'FULLY_SPECIFIED' and locale = 'en' and voided = 0;
            select concept_id into @member2_concept_id from concept_name where name ="PSA, Type of assessment" and concept_name_type = 'FULLY_SPECIFIED' and locale = 'en' and voided = 0;
            select concept_id into @member3_concept_id from concept_name where name ="PSA, Type of activity" and concept_name_type = 'FULLY_SPECIFIED' and locale = 'en' and voided = 0;
            select concept_id into @member4_concept_id from concept_name where name ="PSA, General information" and concept_name_type = 'FULLY_SPECIFIED' and locale = 'en' and voided = 0;
            select concept_id into @member5_concept_id from concept_name where name ="PSA, Clinical assessment" and concept_name_type = 'FULLY_SPECIFIED' and locale = 'en' and voided = 0;
            select concept_id into @member6_concept_id from concept_name where name ="PSA, Screening tool" and concept_name_type = 'FULLY_SPECIFIED' and locale = 'en' and voided = 0;
            select concept_id into @member7_concept_id from concept_name where name ="PSA, Findings" and concept_name_type = 'FULLY_SPECIFIED' and locale = 'en' and voided = 0;
            select concept_id into @member8_concept_id from concept_name where name ="PSA, Discharge Assessment" and concept_name_type = 'FULLY_SPECIFIED' and locale = 'en' and voided = 0;
            call add_concept_set_members(@concept_id, @member1_concept_id, 1);
            call add_concept_set_members(@concept_id, @member2_concept_id, 2);
            call add_concept_set_members(@concept_id, @member3_concept_id, 3);
            call add_concept_set_members(@concept_id, @member4_concept_id, 4);
            call add_concept_set_members(@concept_id, @member5_concept_id, 5);
            call add_concept_set_members(@concept_id, @member6_concept_id, 6);
            call add_concept_set_members(@concept_id, @member7_concept_id, 7);
            call add_concept_set_members(@concept_id, @member8_concept_id, 8);
        </sql>
    </changeSet>

    <changeSet id="AMMAN_CONFIG_202102010017" author="Tarun">
        <preConditions onFail="MARK_RAN">
            <sqlCheck expectedResult="0">
                select count(*) from concept_answer ca
                join
                concept_name cn
                on ca.concept_id = cn.concept_id
                where ca.answer_concept IN (select concept_id from concept_name where name IN
                ("PSA, Referral source", "PSA, Personal situation at home", "PSA, Personal situation in hospital", "PSA, Previous MH treatment", "PSA, Comment on the general information")
                and concept_name_type = "FULLY_SPECIFIED")
                AND
                cn.concept_id IN (select concept_id from concept_name where name = "PSA, General information");
            </sqlCheck>
        </preConditions>
        <comment>Adding Set Members to General information</comment>
        <sql>
            select concept_id into @concept_id from concept_name where name = "PSA, General information" and
            concept_name_type = 'FULLY_SPECIFIED' and locale = "en" and voided = 0;
            set @member1_concept_id = 0;
            set @member2_concept_id = 0;
            set @member3_concept_id = 0;
            set @member4_concept_id = 0;
            set @member5_concept_id = 0;
            select concept_id into @member1_concept_id from concept_name where name ="PSA, Referral source" and concept_name_type = 'FULLY_SPECIFIED' and locale = 'en' and voided = 0;
            select concept_id into @member2_concept_id from concept_name where name ="PSA, Personal situation at home" and concept_name_type = 'FULLY_SPECIFIED' and locale = 'en' and voided = 0;
            select concept_id into @member3_concept_id from concept_name where name ="PSA, Personal situation in hospital" and concept_name_type = 'FULLY_SPECIFIED' and locale = 'en' and voided = 0;
            select concept_id into @member4_concept_id from concept_name where name ="PSA, Previous MH treatment" and concept_name_type = 'FULLY_SPECIFIED' and locale = 'en' and voided = 0;
            select concept_id into @member5_concept_id from concept_name where name ="PSA, Comment on the general information" and concept_name_type = 'FULLY_SPECIFIED' and locale = 'en' and voided = 0;
            call add_concept_set_members(@concept_id, @member1_concept_id, 1);
            call add_concept_set_members(@concept_id, @member2_concept_id, 2);
            call add_concept_set_members(@concept_id, @member3_concept_id, 3);
            call add_concept_set_members(@concept_id, @member4_concept_id, 4);
            call add_concept_set_members(@concept_id, @member5_concept_id, 5);
        </sql>
    </changeSet>

    <changeSet id="AMMAN_CONFIG_202102010018" author="Tarun">
        <preConditions onFail="MARK_RAN">
            <sqlCheck expectedResult="0">
                select count(*) from concept_answer ca
                join
                concept_name cn
                on ca.concept_id = cn.concept_id
                where ca.answer_concept IN (select concept_id from concept_name where name IN
                ("PSA, Severity of symptoms (CGI-S scale)", "PSA, Improvement / outcomes (CGI-I scale)", "PSA, General comment about session")
                and concept_name_type = "FULLY_SPECIFIED")
                AND
                cn.concept_id IN (select concept_id from concept_name where name = "PSA, Clinical assessment");
            </sqlCheck>
        </preConditions>
        <comment>Adding Set Members to Clinical assessment</comment>
        <sql>
            select concept_id into @concept_id from concept_name where name = "PSA, Clinical assessment" and
            concept_name_type = 'FULLY_SPECIFIED' and locale = "en" and voided = 0;
            set @member1_concept_id = 0;
            set @member2_concept_id = 0;
            set @member3_concept_id = 0;
            select concept_id into @member1_concept_id from concept_name where name ="PSA, Severity of symptoms (CGI-S scale)" and concept_name_type = 'FULLY_SPECIFIED' and locale = 'en' and voided = 0;
            select concept_id into @member2_concept_id from concept_name where name ="PSA, Improvement / outcomes (CGI-I scale)" and concept_name_type = 'FULLY_SPECIFIED' and locale = 'en' and voided = 0;
            select concept_id into @member3_concept_id from concept_name where name ="PSA, General comment about session" and concept_name_type = 'FULLY_SPECIFIED' and locale = 'en' and voided = 0;
            call add_concept_set_members(@concept_id, @member1_concept_id, 1);
            call add_concept_set_members(@concept_id, @member2_concept_id, 2);
            call add_concept_set_members(@concept_id, @member3_concept_id, 3);
        </sql>
    </changeSet>

    <changeSet id="AMMAN_CONFIG_202102010019" author="Tarun">
        <preConditions onFail="MARK_RAN">
            <sqlCheck expectedResult="0">
                select count(*) from concept_answer ca
                join
                concept_name cn
                on ca.concept_id = cn.concept_id
                where ca.answer_concept IN (select concept_id from concept_name where name IN
                ("PSA, PSYCa 3-36 months", "PSA, PSYCa 3-6 (child)", "PSA, SDQ (7 to 14 years old)", "PSA, PHQ4 (15 and more)", "PSA, Comment on the screening tool")
                and concept_name_type = "FULLY_SPECIFIED")
                AND
                cn.concept_id IN (select concept_id from concept_name where name = "PSA, Screening tool");
            </sqlCheck>
        </preConditions>
        <comment>Adding Set Members to Screening tool</comment>
        <sql>
            select concept_id into @concept_id from concept_name where name = "PSA, Screening tool" and
            concept_name_type = 'FULLY_SPECIFIED' and locale = "en" and voided = 0;
            set @member1_concept_id = 0;
            set @member2_concept_id = 0;
            set @member3_concept_id = 0;
            set @member4_concept_id = 0;
            set @member5_concept_id = 0;
            select concept_id into @member1_concept_id from concept_name where name ="PSA, PSYCa 3-36 months" and concept_name_type = 'FULLY_SPECIFIED' and locale = 'en' and voided = 0;
            select concept_id into @member2_concept_id from concept_name where name ="PSA, PSYCa 3-6 (child)" and concept_name_type = 'FULLY_SPECIFIED' and locale = 'en' and voided = 0;
            select concept_id into @member3_concept_id from concept_name where name ="PSA, SDQ (7 to 14 years old)" and concept_name_type = 'FULLY_SPECIFIED' and locale = 'en' and voided = 0;
            select concept_id into @member4_concept_id from concept_name where name ="PSA, PHQ4 (15 and more)" and concept_name_type = 'FULLY_SPECIFIED' and locale = 'en' and voided = 0;
            select concept_id into @member5_concept_id from concept_name where name ="PSA, Comment on the screening tool" and concept_name_type = 'FULLY_SPECIFIED' and locale = 'en' and voided = 0;
            call add_concept_set_members(@concept_id, @member1_concept_id, 1);
            call add_concept_set_members(@concept_id, @member2_concept_id, 2);
            call add_concept_set_members(@concept_id, @member3_concept_id, 3);
            call add_concept_set_members(@concept_id, @member4_concept_id, 4);
            call add_concept_set_members(@concept_id, @member5_concept_id, 5);
        </sql>
    </changeSet>

    <changeSet id="AMMAN_CONFIG_202102010020" author="Tarun">
        <preConditions onFail="MARK_RAN">
            <sqlCheck expectedResult="0">
                select count(*) from concept_answer ca
                join
                concept_name cn
                on ca.concept_id = cn.concept_id
                where ca.answer_concept IN (select concept_id from concept_name where name IN
                ("PSA, Syndrome", "PSA, Secondary Syndrome", "PSA, Does the patient need a follow-up?", "PSA, General observations (main symptoms, syndrome,..)", "PSA, Recommendations for medical/physio team")
                and concept_name_type = "FULLY_SPECIFIED")
                AND
                cn.concept_id IN (select concept_id from concept_name where name = "PSA, Findings");
            </sqlCheck>
        </preConditions>
        <comment>Adding Set Members to Findings</comment>
        <sql>
            select concept_id into @concept_id from concept_name where name = "PSA, Findings" and
            concept_name_type = 'FULLY_SPECIFIED' and locale = "en" and voided = 0;
            set @member1_concept_id = 0;
            set @member2_concept_id = 0;
            set @member3_concept_id = 0;
            set @member4_concept_id = 0;
            set @member5_concept_id = 0;
            select concept_id into @member1_concept_id from concept_name where name ="PSA, Syndrome" and concept_name_type = 'FULLY_SPECIFIED' and locale = 'en' and voided = 0;
            select concept_id into @member2_concept_id from concept_name where name ="PSA, Secondary Syndrome" and concept_name_type = 'FULLY_SPECIFIED' and locale = 'en' and voided = 0;
            select concept_id into @member3_concept_id from concept_name where name ="PSA, Does the patient need a follow-up?" and concept_name_type = 'FULLY_SPECIFIED' and locale = 'en' and voided = 0;
            select concept_id into @member4_concept_id from concept_name where name ="PSA, General observations (main symptoms, syndrome,..)" and concept_name_type = 'FULLY_SPECIFIED' and locale = 'en' and voided = 0;
            select concept_id into @member5_concept_id from concept_name where name ="PSA, Recommendations for medical/physio team" and concept_name_type = 'FULLY_SPECIFIED' and locale = 'en' and voided = 0;
            call add_concept_set_members(@concept_id, @member1_concept_id, 1);
            call add_concept_set_members(@concept_id, @member2_concept_id, 2);
            call add_concept_set_members(@concept_id, @member3_concept_id, 3);
            call add_concept_set_members(@concept_id, @member4_concept_id, 4);
            call add_concept_set_members(@concept_id, @member5_concept_id, 5);
        </sql>
    </changeSet>

    <changeSet id="AMMAN_CONFIG_202102010021" author="Tarun">
        <preConditions onFail="MARK_RAN">
            <sqlCheck expectedResult="0">
                select count(*) from concept_answer ca
                join
                concept_name cn
                on ca.concept_id = cn.concept_id
                where ca.answer_concept IN (select concept_id from concept_name where name IN
                ("PSA, Presence of patient", "PSA, Reason of discharge", "PSA, Comment on the process of care and discharge", "PSA, Comment on the referral", "PSA, Prescribers: Comment on the process of care and discharge")
                and concept_name_type = "FULLY_SPECIFIED")
                AND
                cn.concept_id IN (select concept_id from concept_name where name = "PSA, Discharge Assessment");
            </sqlCheck>
        </preConditions>
        <comment>Adding Set Members to Discharge Assessment</comment>
        <sql>
            select concept_id into @concept_id from concept_name where name = "PSA, Discharge Assessment" and
            concept_name_type = 'FULLY_SPECIFIED' and locale = "en" and voided = 0;
            set @member1_concept_id = 0;
            set @member2_concept_id = 0;
            set @member3_concept_id = 0;
            set @member4_concept_id = 0;
            set @member5_concept_id = 0;
            select concept_id into @member1_concept_id from concept_name where name ="PSA, Presence of patient" and concept_name_type = 'FULLY_SPECIFIED' and locale = 'en' and voided = 0;
            select concept_id into @member2_concept_id from concept_name where name ="PSA, Reason of discharge" and concept_name_type = 'FULLY_SPECIFIED' and locale = 'en' and voided = 0;
            select concept_id into @member3_concept_id from concept_name where name ="PSA, Comment on the process of care and discharge" and concept_name_type = 'FULLY_SPECIFIED' and locale = 'en' and voided = 0;
            select concept_id into @member4_concept_id from concept_name where name ="PSA, Comment on the referral" and concept_name_type = 'FULLY_SPECIFIED' and locale = 'en' and voided = 0;
            select concept_id into @member5_concept_id from concept_name where name ="PSA, Prescribers: Comment on the process of care and discharge" and concept_name_type = 'FULLY_SPECIFIED' and locale = 'en' and voided = 0;
            call add_concept_set_members(@concept_id, @member1_concept_id, 1);
            call add_concept_set_members(@concept_id, @member2_concept_id, 2);
            call add_concept_set_members(@concept_id, @member3_concept_id, 3);
            call add_concept_set_members(@concept_id, @member4_concept_id, 4);
            call add_concept_set_members(@concept_id, @member5_concept_id, 5);
        </sql>
    </changeSet>

    <changeSet id="AMMAN_CONFIG_202102010022" author="Tarun">
        <preConditions onFail="MARK_RAN">
            <sqlCheck expectedResult="0">
                select COUNT(*) from concept_set cs
                join concept_name cn
                on cs.concept_id = cn.concept_id
                where cs.concept_id IN (select concept_id from concept_name where name ='PSA, Psycho-Social Assessment'  AND concept_name_type = "FULLY_SPECIFIED")
                and cs.concept_set IN (select concept_id from concept_name where name = 'All Observation Templates');
            </sqlCheck>
        </preConditions>
        <comment>Adding set members to all observation templates</comment>
        <sql>
            set @concept_id = 0;
            set @member1_concept_id = 0;

            select concept_id into @concept_id from concept_name where name = 'All Observation Templates' and concept_name_type = 'FULLY_SPECIFIED' and locale = 'en' and voided = 0;

            select concept_id into @member1_concept_id from concept_name where name = 'PSA, Psycho-Social Assessment' and concept_name_type = 'FULLY_SPECIFIED' and locale = 'en' and voided = 0;

            call add_concept_set_members (@concept_id, @member1_concept_id, 1);
        </sql>
    </changeSet>
    <changeSet id="AMMAN_CONFIG_202102111627" author="Pritam">
        <preConditions onFail="MARK_RAN">
            <sqlCheck expectedResult="0">
                select count(*) from concept_name  where name='Psycho-Social Assessment' and concept_name_type='SHORT' and voided = 0;
            </sqlCheck>
        </preConditions>
        <comment>Renaming Psycho-Social Assessment to Mental Health assessment </comment>
        <sql>
            update concept_name set name ='Mental Health assessment'  where name ='Psycho-Social Assessment' and voided = 0 and concept_name_type='SHORT';
        </sql>
    </changeSet>
</databaseChangeLog>
